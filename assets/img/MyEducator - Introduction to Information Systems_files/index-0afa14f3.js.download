function e(){import.meta.url,import("_").catch((()=>1))}import{g as t,e as s,a,c as l,n,A as o,I as i,k as r,b as u,E as p,M as c,B as d,L as v,d as m}from"./app-lib-3de604a8.js";import{f as y}from"./vendor-base-b5113afd.js";import{R as h,w as f,j as g,C as x,b as j,r as w,P as N,q as T,k as E,F as b,S,s as M,B as C,M as I}from"./vendor-other-705fc60d.js";import"./vendor-xml-5b3ff65f.js";import"./vendor-intl-bd68de4f.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const _=h.createContext({});function A(){return h.useContext(_).instance}_.displayName="ChatContext",l(_,"_chat_context_wrapper",(e=>{e.ctxChat=e._chat_context_wrapper.instance})),t("chat-context");const O=f(class extends h.PureComponent{constructor(){super(...arguments),this.processing=!1,this.msgs=[],this.suggestions=[],this.state={renderCounter:-1,displayWin:!1},this.setProcessing=e=>{this.processing=e,this.setState({renderCounter:n()})},this.toggleWindowDisplay=()=>{this.setState((e=>({displayWin:!e.displayWin})))},this.clearMessages=()=>{this.msgs=[],this.suggestions=[],localStorage.removeItem("chatMessages"),this.setState({renderCounter:n()})},this.handleNewMsg=async e=>{this.processing=!0;const t=o.get().apiClient("aichat","v1");let s;this.suggestions=[],this.setState({renderCounter:n()});const a={messages:this.msgs,user_input:e};this.msgs.push({role:"user",content:e});let l=0;let i=500;const r=async()=>{try{let e={path:`chatbot/${this.props.coursenum||"942hd"}`,data:a};s=await t.post(e);let l=[];s.data.messages.forEach((e=>{"assistant"!==e.role&&"user"!==e.role||l.push({role:e.role,content:e.content})})),this.msgs=l,this.suggestions=s.data.suggestions||[];const o=this.msgs.slice(-20);localStorage.setItem("chatMessages",JSON.stringify(o)),this.processing=!1,this.setState({renderCounter:n()})}catch(e){console.error("Post attempt failed:",e),l<5?(await new Promise((e=>setTimeout(e,i))),l+=1,i*=2,console.log(`Retrying... attempt ${l}`),r()):(console.error("All retries failed."),this.processing=!1,this.setState({renderCounter:n()}))}};r()}}componentDidMount(){const e=localStorage.getItem("chatMessages");e&&(this.msgs=JSON.parse(e))}render(){return g.jsx(_.Provider,{value:{instance:this},children:this.props.children})}});function L(){const e=A();return g.jsxs(x.Header,{className:"d-flex align-items-center",style:{padding:"10px"},children:[g.jsx(x.Title,{className:"flex-maximal text-capitalize",children:"Virtual Assistant"}),g.jsxs("div",{className:"d-flex",children:[g.jsxs("div",{className:"tooltip-container",children:[g.jsx(j,{variant:"gray-tertiary",onClick:()=>{e.clearMessages()},className:"flex-minimal rounded-circle",style:{padding:"10px"},"aria-label":"clear chat history",children:g.jsx(i,{icon:"fa-trash-undo",size:"2x",solid:!0})}),"  ",g.jsx("span",{className:"tooltip-text",children:"Clear messages"})]}),g.jsx(j,{variant:"gray-tertiary",onClick:()=>{e.toggleWindowDisplay()},className:"flex-minimal rounded-circle",style:{padding:"10px"},"aria-label":"close chat window",children:g.jsx(i,{icon:"faTimes",size:"2x"})})]})]})}function P(e){let t=A(),s=t.msgs;return w.useEffect((()=>{N.highlightAll()}),[s]),g.jsxs("div",{className:"chatMessages",children:[s.map(((e,t)=>"user"===e.role?g.jsx("div",{className:"userMsgContainer",children:g.jsx("div",{className:"chatMessage user mx-0p3",children:g.jsx("span",{children:e.content})})},t):g.jsxs("div",{className:"botMsgContainer",children:[g.jsx("div",{className:"messageTag",children:"Virtual Assistant"}),g.jsx("div",{className:"chatMessage bot mb-1 mx-0p3",children:g.jsx(T,{children:e.content})})]},t))),g.jsx(k,{}),t.processing&&g.jsx(V,{})]})}const k=()=>{const e=w.useRef();return w.useEffect((()=>e.current.scrollIntoView())),g.jsx("div",{ref:e})},V=e=>g.jsxs("div",{children:[g.jsx("div",{className:"messageTag",children:"Virtual Assistant"}),g.jsxs("div",{className:"bouncing-loader d-flex pb-1",children:[g.jsx("div",{}),g.jsx("div",{}),g.jsx("div",{})]})]});function z(e){const t=A(),s=h.useRef(),a=h.useRef(),l=h.useMemo((()=>r({onKeyDown_Enter:e=>{e.defaultPrevented||(e.preventDefault(),a.current.submitForm())}})),[]);return g.jsx(E,{validateOnChange:!1,validateOnBlur:!1,initialValues:{text:""},innerRef:a,onSubmit:async(e,a)=>{let l=e.text;a.resetForm({values:{text:""}});try{await t.handleNewMsg(l)}catch(n){console.error(n)}window.setTimeout((()=>{var e;null==(e=s.current)||e.focus()}),25)},children:e=>g.jsx(b,{onSubmit:e.handleSubmit,children:g.jsxs("div",{className:"d-flex inputContainer align-items-center",children:[g.jsx("div",{className:"flex-maximal",children:g.jsx(u,{className:"border-0",ref:s,as:p,name:"text",placeholder:"Ask your question here...",autoComplete:"off",autoFocus:!0,onKeyDown:l,"aria-label":"ai chat input",style:{resize:"none"}})}),g.jsx("div",{className:"flex-minimal",children:g.jsx(j,{className:"flex-minimal submitChat",type:"submit",disabled:""===e.values.text.trim(),children:g.jsx(i,{icon:"faPaperPlane",weight:"solid"})})})]})})})}function H(e){let t=A(),s=t.suggestions;return g.jsx("div",{className:"d-flex flex-wrap ps-0p3 pt-0p2 mx-1",children:s.map(((e,s)=>g.jsx("button",{className:"suggestion py-0p3 px-0p6 mt-0p4 me-0p5 rounded-3",onClick:()=>{return s=e,void t.handleNewMsg(s);var s},children:e},s)))})}function G(e){const t=A();return g.jsxs("div",{className:"aiChat",children:[t.state.displayWin&&g.jsxs(x,{className:"aiChatWindow",children:[g.jsx(L,{}),g.jsx(x.Body,{className:"msgSection border-top p-0",children:g.jsx(P,{})}),g.jsxs(x.Footer,{className:"border-top p-0 footerDetails",children:[g.jsx(H,{}),g.jsx(z,{})]})]}),g.jsx("div",{className:"d-flex justify-content-end me-1 mt-1",children:g.jsx(j,{className:"aiChatToggle",onClick:t.toggleWindowDisplay,"aria-label":"virtual assistant",children:g.jsx(i,{icon:"faComment",weight:"solid",flip:"horizontal"})})})]})}function B(e){return g.jsxs(S,{children:[g.jsx(M,{path:"/",children:g.jsx(G,{})}),g.jsx(M,{children:g.jsx(c,{className:"my-2 text-center",message:"This page has left the building [invalid or unknown path]."})})]})}const D={en:{FnfezUqXGjMI:[{type:0,value:"across the "},{type:1,value:"subs"},{type:0,value:" most recent "},{offset:0,options:{one:{value:[{type:0,value:"attempt"}]},other:{value:[{type:0,value:"attempts"}]}},pluralType:"cardinal",type:6,value:"subs"},{type:0,value:"."}],Vn6sjvEwHkZK:[{type:1,value:"count"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"record"}]},other:{value:[{type:0,value:"records"}]}},pluralType:"cardinal",type:6,value:"count"},{type:0,value:"."}],Vrh8f2BVOLwy:[{type:0,value:"Search"}],"admin.pages.search.form.placeholder":[{type:0,value:"Search"}],c_3Gzhj7KLHI:[{type:1,value:"subs"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"attempt"}]},other:{value:[{type:0,value:"attempts"}]}},pluralType:"cardinal",type:6,value:"subs"},{type:0,value:" allowed."}],"epoch.duration.days":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"day"}]},other:{value:[{type:0,value:"days"}]},two:{value:[{type:0,value:"days"}]},zero:{value:[{type:0,value:"days"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.hours":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"hour"}]},other:{value:[{type:0,value:"hours"}]},two:{value:[{type:0,value:"hours"}]},zero:{value:[{type:0,value:"hours"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.millis":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"millisecond"}]},other:{value:[{type:0,value:"milliseconds"}]},two:{value:[{type:0,value:"milliseconds"}]},zero:{value:[{type:0,value:"milliseconds"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.minutes":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"minute"}]},other:{value:[{type:0,value:"minutes"}]},two:{value:[{type:0,value:"minutes"}]},zero:{value:[{type:0,value:"minutes"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.seconds":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"second"}]},other:{value:[{type:0,value:"seconds"}]},two:{value:[{type:0,value:"seconds"}]},zero:{value:[{type:0,value:"seconds"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.weeks":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"week"}]},other:{value:[{type:0,value:"weeks"}]},two:{value:[{type:0,value:"weeks"}]},zero:{value:[{type:0,value:"weeks"}]}},pluralType:"cardinal",type:6,value:"num"}],fkUMsTGn8rzM:[{type:0,value:"asdfasdf"}],"reader.pages.index.noauth":[{type:0,value:"Not authenticated: please launch from your LMS."}]},es:{FnfezUqXGjMI:[{type:0,value:"across the "},{type:1,value:"subs"},{type:0,value:" most recent "},{offset:0,options:{one:{value:[{type:0,value:"attempt"}]},other:{value:[{type:0,value:"attempts"}]}},pluralType:"cardinal",type:6,value:"subs"},{type:0,value:"."}],Vn6sjvEwHkZK:[{type:1,value:"count"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"record"}]},other:{value:[{type:0,value:"records"}]}},pluralType:"cardinal",type:6,value:"count"},{type:0,value:"."}],Vrh8f2BVOLwy:[{type:0,value:"Search"}],"admin.pages.search.form.placeholder":[{type:0,value:"Search"}],c_3Gzhj7KLHI:[{type:1,value:"subs"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"attempt"}]},other:{value:[{type:0,value:"attempts"}]}},pluralType:"cardinal",type:6,value:"subs"},{type:0,value:" allowed."}],"epoch.duration.days":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"day"}]},other:{value:[{type:0,value:"days"}]},two:{value:[{type:0,value:"days"}]},zero:{value:[{type:0,value:"days"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.hours":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"hour"}]},other:{value:[{type:0,value:"hours"}]},two:{value:[{type:0,value:"hours"}]},zero:{value:[{type:0,value:"hours"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.millis":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"millisecond"}]},other:{value:[{type:0,value:"milliseconds"}]},two:{value:[{type:0,value:"milliseconds"}]},zero:{value:[{type:0,value:"milliseconds"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.minutes":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"minute"}]},other:{value:[{type:0,value:"minutes"}]},two:{value:[{type:0,value:"minutes"}]},zero:{value:[{type:0,value:"minutes"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.seconds":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"second"}]},other:{value:[{type:0,value:"seconds"}]},two:{value:[{type:0,value:"seconds"}]},zero:{value:[{type:0,value:"seconds"}]}},pluralType:"cardinal",type:6,value:"num"}],"epoch.duration.weeks":[{type:1,value:"num"},{type:0,value:" "},{offset:0,options:{one:{value:[{type:0,value:"week"}]},other:{value:[{type:0,value:"weeks"}]},two:{value:[{type:0,value:"weeks"}]},zero:{value:[{type:0,value:"weeks"}]}},pluralType:"cardinal",type:6,value:"num"}],fkUMsTGn8rzM:[{type:0,value:"Not authenticated: please launch from your LMS."}],"reader.pages.index.noauth":[{type:0,value:"Not authenticated: please launch from your LMS."}]}};y.setOptions({strict:!1});class F extends d{}F.ELEMENT_NAME="AiChatElement",F.ELEMENT_TAG=`vapp-${s.VOSHI_APP}`,F.REACT_COMPONENT=function({webcomp:e,...t}){var a;const l=e.isStandalone?C:I;return g.jsx(v,{messages:D,children:g.jsx(l,{basename:`/${s.VOSHI_APP}/${s.VOSHI_BUILD1}`,initialEntries:e.config.host?[(null==(a=e.config)?void 0:a.location)||`/${s.VOSHI_APP}/${s.VOSHI_BUILD1}`]:void 0,initialIndex:e.config.host?0:void 0,children:g.jsx(m,{children:g.jsx(O,{webcomp:e,userid:e.config.userid||e.getAttribute("userid"),coursenum:e.config.userid||e.getAttribute("coursenum"),children:g.jsx(B,{})})})})})},F.CONFIG={...d.CONFIG,userid:void 0,coursenum:void 0},F.ATTRIBUTES={...d.ATTRIBUTES,userid:void 0,coursenum:void 0},function(e){const l=t("voshi");try{if(!s.VOSHI_APP)throw new Error("environment is missing VOSHI_APP");if(!s.VOSHI_STAGE)throw new Error("environment is missing VOSHI_STAGE");if(!s.VOSHI_BUILD)throw new Error("environment is missing VOSHI_BUILD");if(!s.VOSHI_PLATFORM)throw new Error("environment is missing VOSHI_PLATFORM");l.force("welcome to {}",s.appsig)(),s.appsig!==a.appsig&&l.force("built as {}",a.appsig)(),window.customElements.get(e.ELEMENT_TAG)?l.info(`custom element already defined for <${e.ELEMENT_TAG}>`)():(l.info(`defining custom element ${e.ELEMENT_NAME} for <${e.ELEMENT_TAG}>`)(),window.customElements.define(e.ELEMENT_TAG,e))}catch(n){l.error("Error loading app",n)()}}(F);export{e as __vite_legacy_guard};
